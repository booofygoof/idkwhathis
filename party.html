<!DOCTYPE html>
<html>
    <head>
        <title>DJ Booth</title>
        <link rel="stylesheet" href="style.css" />
        <link rel="shortcut icon" type="image/png" width="32px" href="public/favicon-32x32.png"/>
        <link rel="icon" type="image/png" sizes="16x16" href="public/favicon-16x16.png"/>
        <meta http-equiv="Permissions-Policy" content="interest-cohort=()">

        <script src="https://unpkg.com/web3@1.10.0/dist/web3.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/bignumber.js/9.1.1/bignumber.min.js" integrity="sha512-RDkOXE/q9gnuJ/SUl8bUwbYOOXO8orhgIucuMbm3Wk8dtA/cNaUnWYrDONUwWsR//QmuPEIKyyudaP0c+EmMOQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <!-- metadata fetch -->
        <!-- <script>
            let fetchNFTData = async (collection, id) => {
                //if u steal this fuk u
                const apiKey = "51af642c93d846f7821865a7e3ab05d1";
                const apiKeySecret = "806aff78b8b94437a04ee0b13d5d0612";
                const nftUrl = `https://nft.api.infura.io/networks/1/nfts/${collection}/tokens/${id}?resyncMetadata=false`;
                
                const response = await fetch(nftUrl, {
                headers: {
                    'Authorization': `Basic ${btoa(`${apiKey}:${apiKeySecret}`)}`,
                    'Accept': 'application/json'
                }
                });
            
                if (response.ok) {
                const data = await response.json();
                // Handle the response data
                //console.log(data);
                return data;
                } else {
                console.error('Fetch Error:', response.status, response.statusText);
                }
            };
            function editCID (meta) {
                console.log('we are get meta picture here:',meta);
                return meta.slice(6)
            }
        </script> -->
        <!-- frontend stuff -->
        <script>
            //Dropdown
                // Select all dropdown parent elements
                var dropdownParents = document.querySelectorAll('.dropdown');
            
                // Add click event listener to each dropdown parent
                dropdownParents.forEach(function (parent) {
                parent.addEventListener('click', function () {
                    // Toggle the "active" class on the clicked dropdown parent
                    this.classList.toggle('active');
            
                    // Toggle the visibility of the dropdown content
                    var dropdownContent = this.querySelector('.dropitems');
                    dropdownContent.classList.toggle('show');
                });
                });
            
                // Close the dropdown when clicking outside of it
                window.addEventListener('click', function (event) {
                dropdownParents.forEach(function (parent) {
                    if (!parent.contains(event.target)) {
                    parent.classList.remove('active');
                    var dropdownContent = parent.querySelector('.dropitems');
                    dropdownContent.classList.remove('show');
                    }
                });
                });
            //Popup
                function closePop(which) {
                    var pop;
                    switch(which){
                        case 1:
                            pop = document.getElementById('pop');
                            break;
                        case 2:
                            pop = document.getElementById('pop2');
                            break;
                        case 3:
                            pop = document.getElementById('pop3');
                            break;
                        default:
                            pop = document.getElementById('pop');
                            break;
                    }
                    pop.innerHTML = '';
                    pop.style.display = 'none';
                }
                showPop = (which) => {
                    var pop;
                    switch(which){
                        case 1:
                            pop = document.getElementById('pop');
                            pop.innerHTML += '<div class="x" onclick="closePop(1)">x</div>'
                            break;
                        case 2:
                            pop = document.getElementById('pop2');
                            pop.innerHTML += '<div class="x" onclick="closePop(2)">x</div>'
                            break;
                        case 3:
                            pop = document.getElementById('pop3');
                            // pop.innerHTML += '<div class="x" onclick="closePop(3)">x</div>'
                            break;
                    }
                    pop.style.display = 'block';
                }
                popPop = (innerHTML,which) => {
                    var pop;
                    switch(which){
                        case 0:
                            pop = document.getElementById('dashboard');
                            pop.innerHTML = innerHTML;
                            break;
                        case 1:
                            pop = document.getElementById('pop');
                            pop.innerHTML = '<div class="x" onclick="closePop(1)">x</div>'+innerHTML;
                            break;
                        case 2:
                            pop = document.getElementById('pop2');
                            pop.innerHTML = '<div class="x" onclick="closePop(2)">x</div>'+innerHTML;
                            break;
                        case 3:
                            pop = document.getElementById('pop3');
                            pop.innerHTML = '<div class="x" onclick="closePop(3)">x</div>'+innerHTML;
                            break;
                    } 
                }
            //Get
                function get(id) {
                   return document.getElementById(id);
                }
            //TX Receipt
            function gibReceipt(tx,desc) {

                    var innerHTML = 
                        `
                        <img id="cashier" src="public/milkbar1.png"/>
                        <div id="receipt">
                            <h3 class="center">Congratulations! You have just ${desc}</h3>
                            <p class="center">You can see your transaction here:</p>
                            <a class="center white-link" target="_blank" href="https://etherscan.io/tx/${tx}">${tx}</a>
                        </div>
                        `;
                    popPop(innerHTML,3);
                    showPop(3);
                }
        </script>
    </head>

    
    <body>
        
        <div class="toolbar">
            <div class="topbar">
                <p>Mony</p>
            </div>
            <div class="menu">
                <div class="logo">
                    <img src="public/logo.png"/>
                </div>
                <div class="options">
                    <ul>
                        <li>
                            <div class="dropdown">
                                Collections
                                <div class="dropitems">
                                    <a href="https://nftx.io/vault/0x855882cc65ba66cdbc7a8c512143f10169891307/buy/" target="_blank">MiladyStation</a>
                                    <a href="https://opensea.io/collection/cigstation" target="_blank">CigStation</a>
                                    <a href="https://opensea.io/collection/mony-missingno" target="_blank">MissingNo.</a>
                                </div>
                            </div>
                        </li>

                        </li>
                        <li>                                
                            <div class="dropdown">
                            Consoles
                                <div class="dropitems">
                                    <a href="https://miladycola.net" target="_blank">MiladyCola</a>
                                    <a href="https://monygroup.net/market" target="_blank">MonyMarket</a>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="dropdown">
                            Services
                                <div class="dropitems">
                                    <a href="https://mony-group-lending.bancof.io/borrower/dashboard" target="_blank" >Collateralized Loans</a>
                                    <a href="mailto:monygroupcorporation+monygrouponline@gmail.com?subject=Dev%20Work&body=I%20want%20you%20to%20make%20me%20a%20contract">Smart Contract Development</a>
                                    <a href="mailto:monygroupcorporation+monygrouponline@gmail.com?subject=Dev%20Work&body=I%20want%20you%20to%20make%20me%20a%20website">Website Development</a>
                                    <a href="mailto:monygroupcorporation+monygrouponline@gmail.com?subject=Dev%20Work&body=I%20want%20you%20to%20audit%20my%20project">Audits</a>
                                </div>
                            </div>
                        </li>
                        <li><a href="#">About Us</a></li>
                    </ul>
                </div>
                <div class="search">
                    <input placeholder="search"></input>
                </div>
            </div>
        </div>
            
        <div id="raffle">
            <div class="collectibles">
                <h1>Milady Maker Party HQ</h1>
                <div id="dashboard">
                    <button id="connect" onclick="partyFlow()">Let's Party B^]</button>
                </div>
            </div>
        </div>

        <div id="pop"></div>
        <div id="pop2"></div>
        <div id="pop3"></div>

        <div class="footerwrap">
            <div class="footer">
                <div class="miladystationlogo">
                    <img src="public/bwlogo.png" width="120px" height="90px"/>
                </div>
                <p class="footerblurb">Mony Group Corporation Website</p>
                <div class="footeroption">
                    <ul>
                        <li>Home</li>
                        <li>Terms of Use</li>
                        <li>Privacy Policy</li>
                        <li>MiladyStation.Net</li>
                        <li>Contact Us</li>
                    </ul>
                </div>
                <br/>
                <div class="footerfooter">
                    <p class="copyleft">2023 Mony Group Corporation</p>
                </div>
            </div>
        </div>
        
        <!-- web3 -->
        <script>
            console.log('version 12')
                
                    
                //var web3 = new Web3(new Web3.providers.WebsocketProvider('wss://mainnet.infura.io/ws/v3/51af642c93d846f7821865a7e3ab05d1'));
                //test
                var web3 = new Web3(new Web3.providers.WebsocketProvider('wss://sepolia.infura.io/ws/v3/51af642c93d846f7821865a7e3ab05d1'));
            
                var connected = false;
                var accounts = [];
                const admin = '0x6A0a993cc824457734EC7Cac50744a34EcAf34D4';
                //test
                const creationHash = '0xa699588b268be353911a65731e5769f93e58fe92dd17e17597edbda8e36ce41f';

                var time;
                var winnerMCount;
                var winnerRCount;
                var winnerPCount;

                var randomness = [];

                const partyHat = [ 287,936,812,2180,2664,2831,161,95,2743,1883,1991,2702,2571,2473,614,261,2602,2205,741,1298,300,57,704,786,1979,2826,1407,692,356,834,909,2917,2177,582,2212,2909,2929,1279,1270,2382,121,696,1058,1118,457,1686,2124,1487,57,495,684,1033,1914,2141,1791,2867,2428,624,2780,2612,2730,2367,38,115,2502,90,2491,1810,563,241,1774,199,686,539,395,2215,1102,469,1000,2626,1067,1301,2997,2821,2371,1773,1032,330,1500,153,1859,528,2693,1227,1868,879,2679,234,59,670,2560,354,2467,647,2426,351,840,2106,550,1848,2834,1293,2027,288,932,2688,967,1618,417,843,1639,2593,607,2552,811,2128,559,1205,1794,659,766,1285,275,1179,1001,1308,1567,907,258,2831,1897,1193,2924,753,2570,599,2301,1121,2816,670,132,961,2983,780,451,2540,2777,100,838,433,2917,1125,2812,1665,187,1954,1330,1063,2294,2712,1426,469,1762,1826,2227,1920,309,1039,1614,2788,166,2643,1017,2953,1420,955,1669,1595,2670,293,2144,2991,256,1156,1633,238,2460,1483,1551,1180,2424,2194,1510,975,862,1087,1366,2749,642,83,1126,2982,1393,1798,375,906,2266,1362,2531,1947,1719,1525,1210,2329,2238,991,2296,770,1636,1094,2248,1787,578,883,2948,859,2381,2676,1087,2225,1647,1963,59,1244,912,1195,2843,1285,469,537,947,1309,1081,1671,486,2435,1052,1955,618,388,2345,310,462,2618,2108,701,984,1757,1347,674,2964,2373,59,411,505,1409,67,1956,743,1903,1037,1169,235,370,1716,2056,2858,1331,2958,2832,1191,2093,1516,667,584,2335,139,660,1689,1333,318,1521,660,186,1614,1843,2761,915,144,59,1782,538,1365,2317,2070,227,2157,2740,553,1027,2153,2022,461,2988,1314,2763,2953,377,544,945,1121,2374,115,764,2854,2701,804,2220,380,2608,2418,400,1169,2780,1588,1685,894,678,2278,2136,634,1205,1901,1559,2948,1150,836,466,1994,1915,296,504,1132,1798,2645,1655,356,902,1785,2065,1330,2572,1766,2773,861,2459,789,2783,1814,1521,319,1587,2590,1390,1999,242,728,992,1864,897,2568,2204,146,799,749,656,2208,2931,50,591,1686,1432,2020,2349,268,989,2490,1451,122,1819,2446,777,871,2973,899,2153,2357,1441,712,875,122,2066,874,1702,585,469,2470,693,1131,1187,373,2768,741,2671,1786,2129,2976,1002,197,2669,378,2562,1965,1736,2476,2607,2857,1661,1005,2823,670,1787,1907,2170,2382,2097,1831,275,2384,80,2417,924,1917,313,2567,467,2712,1223,599,2525,53,80,1919,2340,1164,795,2527,14,759,8,2249,1996,20,51,2081,2547,848,1995,2911,601,2074,2767,1691,2375,1232,2951,387,2732,2656,1696,2717,1303,1126,81,1826,1918,2040,683,96,2413,1611,2809,2037,1109,2678,840,787,2619,2896,781,1951,2485,756,995,1233,2034,2804,1092,1933,878,17,2611,2841,2887,2140,1080,642,1835,499,2145,1876,2568,1556,2092,742,2271,1353,1486,1798,2002,2234,815,2422,2081,452,576,1210,1418,2303,179,1512,1960,1729,354,191,220,69,1154,74,1087,1034,1938,2393,614,574,81,2919,2171,670,1976,1017,917,617,2524,186,364,1517,2236,1500,1696,1107,2,910,1884,1934,285,2124,2909,1051,2683,2659,728,363,556,58,1597,2719,1381,127,2916,1296,879,978,1094,836,41,406,2672,2013,896,800,289,951,450,2220,1799,2030,2607,91,2034,2997,2244,358,1016,1087,2362,2047,2217,2895,1841,1715,2951,1581,230,579,651,1160,487,2744,2257,28,278,2793,173,1389,2631,2153,297,1856,794,217,370,2043,2463,239,2884,1614,135,1663,2205,1097,2419,974,1967,1039,2863,303,2917,1686,2244,460,940,681,663,1923,1772,404,711,2033,1873,2599,1087,557,1981,491,721,1256,316,1375,836,102,442,120,232,1314,345,2275,1528,2869,1771,1081,2605,2273,2474,1392,1500,525,1403,2168,458,2682,742,2333,745,546,805,2346,2190,725,2654,1486,2277,107,1808,2378,1356,1662,1382,2118,2601,1699,1529,1494,2191,2564,356,2665,236,2532,1140,240,872,733,1851,1212,1183,1605,1568,1252,2166,2316,163,673,2639,2634,50,2998,677,2308,557,2452,1703,2108,1165,662,336,1466,374,283,1955,1867,1768,1756,1799,414,415,1021,463,2751,779,1214,1840,2125,177,839,1166,486,2817,1313,793,720,1475,2642,212,1452,2582,2231,1044,1682,85,923,242,1185,2360,952,820,156,1769,2206,1407,713,2947,57,524,2000,66,986,1083,1510,1590,2720,1950,2139,2357,2926,977,1845,2451,2956,2619,751,2867,332,2891,324,356,91,740,349,62,1866,1581,2083,2852,717,586,763,2345,252,2250,1052,1989,2759,970,205,1718,1325,2852,1236,469,1823,632,881,2212,1928,2559,1094,1278,33,2297,1744,1500,2729,2866,1144,2359,362,2450,505,1903,860,1315,2216,472,1081,1434,1233,1682,505,2010,442,625,1518,216,341,1175,2689,381,700,1945,1009,464,148,507,435,2727,822,1646,2659,559,2715,2894,2296,2419,1550,98,325,1783,2728,997,775,2772,796,2297,566,308,1783,2588,1479,2142,764,2814,559,117,444,1345,543,1940,1812,69,2304,242,495,2821,2978,1837,2130,1082,1620,374,745,2079,235,2557,2568,1922,1787,248,1553,536,731,914,2015,1467,2017,471,517,1425,2512,1506,1002,2984,2719,928,2321,1577,1417,1099,1968,1903,495,1186,2974,1882,1338,2795,829,2441,1787,802,2879,2176,268,2697,164,1771,1326,1826,652,2218,1928,2299,88,1055,1850,540,1784,1748,2220,103,820,765,1373,763,2184,1453,2783,1174,169,2436,498,1654,1806,1884,1666,2237,2397,2919,478,1421,1865,1614,1316,2031,2069,233,2747,678,2350,1683,2584,518,72,1962,1342,1718,2786,9,2230,368,2419,271,392,123,927,1228,2305,1637,1005,2428,833,1641,965,46,1608,1233,17,1290,1644,1114,2294,127,1442,1943,1334,2115,2262,2949,533,1721,2036,138,1652,2018,2256,1927,2680,767,1211,1817,2656,450,2398,51,2986,836,836,163,820,216,836,791,1013,2949,1045,1523,890,1281,1062,1361,278,473,1262,2819,2388,357,2723,2372,928,1058,1157,2870,640,2221,469,2092,31,864,1490,2606,962,1448,2104,2769,1348,429,1628,1541,911,2085,2235,1090,607,1012,739,305,2616,2930,1147,1555,580,1534,1780,682,2443,1686,32,888,1553,766,2952,1211,1793,930,2917,1966,384,2331,1740,2028,429,1265,1378,1614,2798,272,1056,2041,2754,830,1947,2128,1668,1435,1395,1505,979,1879,2371,749,2743,141,1680,356,1648,352,959,2064,1998,2147,2740,2565,2153,2088,1238,1848,1888,1968,1233,1550,1719,1336,2446,1284,1539,777,671,9,2249,225,1095,2361,2268,460,1321,2640,611,2411,647,421,461,367,2861,1904,1323,2829,2238,2097,1153,2037,1218,2968,225,2595,2278,2818,1073,1139,1497,2577,1230,708,2857,2052,720,627,206,2882,974,2425,2150,1608,701,2187,1489,1845,452,2600,699,2054,812,863,1467,2,108,1125,1693,1990,2917,202,858,2966,1511,1049,2011,546,2878,234,1174,2696,1905,440,1782,2193,302,2960,1485,953,2795,2550,2242,1086,1847,356,2064,386,445,2300,2027,2624,913,1063,2756,516,2403,1224,896,1859,2632,2728,2280,1157,2061,2514,2976,808,1571,2939,2928,1774,2952,421,1551,587,644,976,438,2288,2285,731,1930,446,136,1115,854,623,1337,2822,354,2516,2177,959,2521,2494,719,1407,620,856,1237,880,1917,1825,81,2289,2098,1455,356,106,978,1983,691,2414,2048,259,215,2227,2704,403,1155,367,1875,857,1946,1913,2348,2731,2651,1320,562,1111,2852,688,436,1369,2758,2184,660,2785,1319,2326,2653,2009,2791,115,2842,2156,1447,1615,2493,2638,1602,2891,1778,1015,2801,2382,2121,59,2479,1764,2368,2717,2020,1900,905,1868,1229,803,501,2161,2111,2545,448,2630,1143,2684,1867,1370,224,145,544,59,1254,155,2058,2504,1688,1844,738,642,2893,2810,2975,1360,42,2981,2213,2776,2855,818,1698,2143,933,1346,1038,791,2636,983,2400,1486,784,2836,2619,731,69,2853,237,2120,2963,2771,380,2685,1559,346,2073,2074,2815,68,2322,511,1692,1242,1404,1918,323,1478,2123,2659,648,2163,2886,2649,2226,176,2621,1135,2035,1478,1550,2654,1068,1435,1695,1882,1145,1006,2964,2690,870,1054,1567,16,1123,2753,2358,235,2162,2832,2184,952,676,710,2037,535,1919,1181,1634,1002,1411,2674,2498,1578,1935,2552,2130,824,1756,584,1725,1732,801,846,953,1629,354,2444,2687,1220,886,1246,1500,1035,1249,730,1098,390,356,2279,1642,2239,2482,1410,955,2959,565,2646,2138,1899,2325,2568,783,69,894,2802,2856,731,1952,2501,1087,1508,2383,1004,2524,1816,1341,1253,2525,1599,277,2457,1110,242,2505,1576,587,2864,945,1009,106,1592,1081,2616,1103,2045,1288,2833,2091,2865,379,2845,2249,1152,622,2736,1502,1944,664,1046,2188,1983,279,1870,154,469,1609,2609,61,1268,321,2536,2238,1001,1359,2380,2890,1020,1057,2389,1486,133,2755,2283,1892,1013,2161,2179,1504,1681,531,2289,2327,1659,2382,708,1609,968,1878,182,857,2859,1294,987,115,193,1164,2432,2432,142,1260,2921,2837,1513,980,754,11,1736,2205,2041,769,2657,2438,2748,2623,235,715,1803,2173,1937,2434,228,1497,2639,2569,912,2905,1748,2929,1108,2379,1787,1524,583,1750,2318,726,2376,2151,2219,1401,2171,1159,301,60,2874,1362,1666,1552,410,23,669,15,1583,2062,2386,2285,2500,1454,1167,2246,2817,1988,326,445,153,208,2315,2306,2777,1002,2967,1509,1851,1519,837,426,2132,2427,2797,899,1332,2270,1407,1535,1322,523,2058,1796,996,1203,35,807,1940,1437,1200,1340,2453,2972,2254,2654,2668,1387,2779,944,2813,834,1221,1759,112,1151,2944,1132,994,1581,1519,492,344,2841,617,424,2675,275,1104,2458,1446,2966,728,221,2507,1292,258,1510,702,1863,2028,1101,831,614,2529,1244,1604,1505,2240,1903,1629,117,1532,2128,1926,1564,30,714,898,500,2971,1111,2029,2804,1275,2708,191,1280,1970,469,1507,2852,1792,1520,755,2196,438,83,1457,81,149,624,1898,245,46,161,2071,2934,2139,650,646,219,1226,657,307,2486,1196,27,2117,2692,454,2686,1363,295,1087,1701,1117,2948,1549,2743,1842,1996,1788,740,853,1716,534,2934,1136,1084,2084,356,2043,502,2659,2490,1931,722,1088,2231,497,1604,2805,2298,2256,1357,494,235,1036,1020,654,1953,1233,1055,1905,1596,1820,2977,1684,1787,2203,2089,106,1233,2328,653,2004,1010,311,1023,734,1639,178,900,2820,2356,2178,2918,227,430,115,2645,2568,2596,1526,1414,1243,328,2789,385,573,2183,2224,2674,1385,1133,741,2594,1457,1512,1711,2159,908,2024,322,290,1055,213,889,327,417,343,1654,1703,1464,1740,331,845,296,1222,2777,24,2858,1192,2808,2136,2221,2949,2845,2376,2203,2249,956,2070,571,604,1606,1081,1533,695,469,1327,2365,1459,1451,1235,201,2707,1225,940,2251,1489,1480,1289,1172,1790,2711,395,2700,1571,1932,1128,2874,1525,1393,2852,1773,2140,1855,1399,2781,2365,137,254,2062,2792,2875,963,867,2259,638,2204,2836,1658,124,2710,1992,1264,714,1300,2020,1377,1087,735,2629,110,606,655,2684,1002,628,2876,88,1344,2955,1217,57,690,1624,2205,1045,1395,2190,290,2204,209,304,2710,2367,1032,2503,2839,2109,1002,2644,2796,425,2714,1631,356,2172,1937,2256,1994,75,2335,1619,2393,599,2781,673,115,1673,2453,1171,2199,798,1664,286,1522,2221,547,1120,2430,708,2293,1627,2180,1849,929,88,380,2974,1616,813,77,2135,1642,1291,1106,1673,2152,2042,1324,1208,2229,217,2927,1236,2289,2543,526,1042,2202,869,2320,1580,41,2994,2245,2659,2343,1305,762,1666,1911,952,2241,343,593,607,2811,1323,1032,2080,97,2437,1708,2782,558,2286,513,2378,1488,1081,2646,1339,2945,1935,1486,2220,1626,595,1461,437,2253,570,2533,2501,559,250,1432,402,572,2794,454,88,2012,2336,395,1867,2416,2217,1529,1982,129,1006,2462,1600,819,2451,1347,2487,2303,1456,278,1413,2011,649,1978,671,2017,1018,1949,1416,2861,2576,2777,2852,1797,1407,2484,2330,1933,2615,1259,2021,242,1760,2373,2771,235,2640,2424,2881,545,469,1672,621,1077,1848,1643,1435,1081,1779,1022,2787,1373,2161,1450,2176,1327,1680,2921,468,2054,736,2075,1241,157,1977,817,1429,2496,2052,288,2199,2383,145,2794,148,283,1078,2335,1075,750,1367,1902,2283,1889,2264,1324,1836,1248,2103,1071,788,428,224,2678,1374,2321,1473,1775,1177,1266,2478,1401,849,2575,360,1871,608,2249,1801,816,1307,1126,2946,1462,1596,1257,2640,388,2784,1871,354,2807,1805,2378,1233,1122,2659,403,2265,1612,2053,2574,2076,817,1240,728,2431,1139,429,302,357,718,2035,2725,2395,2840,345,1472,2246,2823,1329,703,2931,65,1613,2471,1249,2598,170,2795,1713,850,2307,2053,1433,1073,104,1682,2008,2330,1860,2423,350,943,2384,1138,1409,2778,11,2059,2775,2907,398,1839,2556,1233,2636,1975,247,1335,1582,510,1136,210,2804,1540,1948,2738,1094,1271,1492,2355,93,2753,2855,2852,211,1346,2186,2309,612,275,2757,121,1881,1002,2535,104,884,2837,969,2880,1366,2409,33,842,354,1315,2366,1686,958,2502,239,152,1650,1565,255,1349,357,257,1903,988,1030,493,1787,1312,1822,235,1010,57,1122,1928,1873,158,2579,2762,1024,1679,1650,1679,2123,1620,1720,568,2383,2735,514,2827,1002,1163,347,1569,1394,2465,2852,105,1407,851,2978,2791,2694,1490,1507,2770,248,1450,2058,306,73,2586,990,2385,146,2455,665,2421,2962,731,633,2292,2173,659,1630,1997,1407,172,642,415,1893,1482,59,2049,605,1571,331,2220,507,1079,1501,158,1859,1064,2160,76,2,1486,1128,1478,1275,2134,809,552,506,1678,1061,299,1198,86,140,2948,2752,752,1885,1065,300,1781,2841,2621,1995,2524,1468,2529,1830,2736,2661,266,2768,499,189,52,1460,1589,149,1087,421,658,2511,2548,40,1880,1061,292,820,852,1297,2877,2399,1777,816,691,1096,589,1686,2614,2448,1872,2698,818,1999,178,1281,2174,1003,2299,174,2357,2750,328,1735,1759,1450,1258,1895,2295,43,2677,1553,646,1618,2974,352,2447,249,2530,668,1595,128,52,2917,661,1639,235,2801,115,926,1836,457,2249,1470,2391,1255,221,2908,2346,586,239,1980,1491,2910,1837,2723,2555,2178,2917,2531,99,1291,1361,2931,48,535,616,1328,1261,276,2214,2193,2508,2480,2539,1776,964,2131,313,1538,126,2127,2236,190,2652,933,1048,896,198,541,1579,2713,1713,496,529,2323,11,2248,4,1251,193,679,1723,670,821,288,670,2184,2797,79,1201,2165,246,2247,1916,69,2842,1666,2176,242,702,1530,2180,2419,1542,1127,1267,1859,2747,836,1272,1050,708,2498,315,592,1247,2515,1129,990,1497,670,2258,2983,401,2128,2541,927,2871,2847,407,164,2117,1885,2579,1244,2954,1884,2943,411,1694,2310,2944,2472,5,2558,1194,2148,160,2935,2800,2354,2913,2210,1968,2957,1344,2023,2198,2958,359,1853,566,2795,2777,2832,459,1005,218,2902,2238,841,1266,2917,1498,838,782,1771,1224,1859,1428,515,2706,2095,1515,689,442,2960,1684,615,74,2771,882,2807,1536,2970,2328,2576,1445,503,2628,1734,2070,1608,346,2341,2939,2783,2004,293,868,6,1766,1614,1908,2551,2587,636,196,1537,2260,2656,2622,335,2132,2992,436,2844,397,1500,2383,2571,2885,1818,1388,1859,802,62,1770,668,338,1884,2568,844,2879,1425,548,1335,1593,2609,333,732,1725,2077,1458,744,571,2850,781,2021,758,2852,1499,893,1084,907,2899,366,832,2090,2122,1221,2038,2468,866,101,1172,2001,1321,1136,1974,2703,1233,214,1653,284,1323,1812,731,1846,1234,2256,1681,2210,982,2342,1856,2166,2483,2774,2432,1070,2189,2267,1321,681,1486,2233,2721,713,1722,2246,2927,931,1170,312,1337,1121,1026,1874,2111,439,898,1647,588,194,2315,2238,119,1224,399,1738,1453,2892,970,1116,2620,938,530,483,1944,1577,687,1407,2176,1263,921,346,307,1985,2778,1745,2993,1622,1206,561,2282,267,2996,2422,577,2337,1030,2666,1815,778,1560,1412,971,1724,559,2211,2940,1099,1859,1092,771,344,1005,704,551,1562,217,282,1312,228,2739,1713,1120,216,2526,1823,2238,2402,1008,559,1161,705,578,2439,269,1561,1344,1594,2171,1216,2458,742,2663,2565,1558,1575,1787,412,1230,1014,1059,1304,1541,939,563,2006,72,1531,172,1000,97,1248,1337,670,2158,760,400,1561,442,2888,1440,1204,2150,624,522,140,2806,1828,1972,1443,2313,2969,1469,2949,1005,1438,694,2657,2425,482,2085,2915,1686,433,1178,887,521,2872,769,2397,2067,1012,1891,2965,2397,63,380,2415,752,946,554,2509,2537,459,2580,69,820,192,2170,145,2757,2007,1248,2816,1765,2553,2528,2088,229,22,945,652,821,346,512,2520,1400,1623,2869,1339,863,989,1572,1344,1682,2221,1733,2509,1906,2625,2182,1041,2777,1392,1887,1534,1890,791,1886,204,85,57,1972,1614,1376,1061,941,1747,2695,2426,843,1085,2848,1896,256,2281,2983,2133,395,897,1868,1019,2475,2559,1800,2522,1742,1476,394,689,2324,1621,2205,904,473,2094,71,1894,485,1435,2120,1771,2469,2608,1755,260,2597,2489,1142,145,668,910,2936,2171,462,1199,2906,1053,2316,202,2849,1476,2807,2302,2568,26,536,2168,1040,1903,643,1814,958,2484,925,2029,2937,2890,922,694,1700,757,1739,1449,1431,1646,2392,780,575,59,859,1878,1729,777,1602,69,1603,2412,1584,111,2617,1716,709,1149,326,109,263,2532,741,438,375,2058,2181,2635,465,2825,276,180,2126,885,2225,664,2740,555,1941,1351,1475,2836,1626,1737,474,1079,2793,1716,2055,914,1282,2220,2067,2734,1236,2958,774,458,1912,2610,719,2566,121,2765,2205,280,2249,1182,1649,253,2945,2845,2994,1329,1986,1474,2868,2025,2807,2731,1664,147,1789,2019,2432,1638,422,1336,2792,294,69,529,1061,121,2207,2169,2290,927,820,641,1554,2830,560,998,885,1481,2890,737,1162,1311,416,2777,2461,1422,1764,298,2950,131,1727,2033,1477,2481,1486,2332,1569,2549,644,441,2310,1247,2573,2238,1444,1398,594,1821,2557,1269,593,389,373,55,2284,163,1751,1910,2002,1303,1802,817,100,1113,2043,1005,1273,2905,575,817,2510,57,251,1237,1753,1130,456,1601,1718,1408,1356,2603,2561,2609,482,2497,2046,2887,1976,2648,264,1969,35,2175,780,2740,937,2137,354,574,1608,2560,1573,348,1156,175,2346,1406,374,2860,106,1113,2364,239,1556,1337,440,1787,2477,1028,945,1585,835,1667,180,2617,670,1069,1334,285,926,2537,235,691,2591,36,1568,2802,2644,2990,2641,706,2746,1043,692,773,408,930,181,2464,2200,2563,2519,2659,1750,118,1647,1936,289,747,1571,1545,612,480,1035,1221,1903,2026,1189,314,163,150,1358,2308,2741,1276,1847,918,2717,2659,240,993,195,1219,2732,567,222,1607,789,2015,1823,2086,605,1265,155,2516,2107,2346,2965,1670,892,1054,599,1925,1859,2999,1500,954,1722,1581,2842,2086,2755,203,2499,1500,2617,2370,1087,1707,2980,1726,558,790,2804,2495,2900,1478,2302,2363,2890,2429,2653,254,2568,999,2824,2985,340,1148,2730,2407,2578,2342,262,1557,2004,2334,631,1659,2020,1686,1588,1413,2118,1439,2418,2146,791,2904,1721,1238,2716,47,660,1739,1797,475,2394,372,788,1826,2784,2444,908,2896,683,2956,1051,2544,2269,1005,613,919,1612,2743,2367,1134,501,2468,285,113,449,2979,65,374,2811,2025,1206,1737,428,354,118,1558,2790,306,2209,1327,1170,2717,2563,477,1003,1651,785,1002,559,2208,1767,2950,2100,1918,1586,1197,130,114,548,775,200,1154,1481,1675,490,519,508,2617,621,242,2504,1176,2322,1583,836,1877,1769,110,1146,412,523,2777,2072,781,1295,2439,2396,1184,2205,1380,2148,1985,1927,1898,355,1262,174,2982,2992,1961,2407,1326,1029,1158,1952,1625,1397,2903,1078,2660,1200,216,2819,1640,2841,471,788,2542,2513,1685,1539,2917,1225,1317,2581,2442,1277,1401,1862,129,1025,2524,2654,1904,2410,2518,168,2851,1752,249,2253,2560,1565,423,2248,1292,1119,2445,1141,218,731,365,1423,856,740,1415,670,812,171,152,630,274,1031,946,1245,2367,1011,2655,1546,2510,190,2691,1859,2716,2938,444,2471,2941,1531,344,1727,2667,1589,270,2005,375,1909,2119,2482,1286,2922,2488,1032,1350,768,2182,1987,85,2708,2517,855,2080,2490,231,1635,2840,2288,34,2263,312,2849,1553,2289,509,596,668,59,1758,2357,87,10,569,2845,1809,1074,175,846,1726,1004,2974,405,828,1005,2249,409,730,1802,333,2188,1823,2746,2566,1384,820,1321,2651,780,371,1999,2347,217,691,2832,1231,330,847,2538,472,1952,1587,2760,1110,2089,2799,637,162,925,903,2369,348,151,1621,419,2014,1623,2050,2349,242,2222,2764,2112,836,2745,1718,2640,2471,422,2914,2952,2870,2917,426,2734,1530,2947,1645,2912,662,2125,1378,1567,1072,863,2589,2091,1857,59,2619,2433,1540,1868,1685,2354,856,2923,626,234,1250,777,243,629,1854,825,1852,42,1354,1895,772,393,1804,12,1691,1749,2683,1544,1971,2119,2637,339,2274,1043,1494,740,630,1493,1112,431,1614,1617,797,125,1761,159,1910,69,3,1973,1647,663,1908,1368,2835,1525,2846,309,2766,1911,1918,1202,1676,1832,680,2164,2750,1198,1115,1089,1639,49,25,985,69,947,1355,361,207,2777,868,335,2401,1268,927,427,307,2517,2228,378,2377,237,2898,1685,2072,1091,1984,184,2405,2700,1937,1857,1769,1306,39,1055,2897,1712,3000,1723,786,2583,2306,776,1423,2223,1848,1728,2068,1060,680,600,803,2095,2662,2016,429,2803,1424,244,2585,2864,2142,2296,18,2966,1686,2722,432,2421,957,2788,1744,2116,1042,1419,934,1463,1534,2110,1322,1327,1310,1838,2742,54,2205,2004,1686,11,2466,382,57,1190,551,2197,610,2037,1348,1693,184,350,1827,1486,58,2248,693,2570,2417,1405,188,57,784,2870,942,2492,1252,1937,1204,895,877,1674,1717,70,1819,559,1967,2733,861,56,2534,1058,2047,1158,221,19,865,115,2311,731,336,82,2863,1283,2673,2988,1148,2936,2280,1731,2159,1068,85,2454,183,1939,2511,966,1811,2656,2249,2659,2523,492,2048,1957,2397,1850,1352,2942,1002,1400,1903,334,609,1005,935,1407,846,1450,143,1709,1054,2813,443,489,1371,1605,1379,2013,1591,435,56,1854,2113,748,1675,2901,317,1903,396,1610,1215,1018,2471,455,1667,1964,883,1076,2906,2842,2108,1566,1223,349,2546,2912,2105,2534,1865,1588,716,2862,982,1244,1808,234,2003,2057,1239,2987,685,470,2573,29,2905,2966,341,2154,1525,134,602,2099,2202,820,274,1411,318,751,788,453,1005,1632,342,896,1903,1343,1992,2587,2479,1769,1870,916,221,698,2098,1724,1150,453,948,2183,1070,1386,2327,2406,823,2889,315,607,319,2378,1859,2742,1763,2630,723,173,1284,1741,639,1302,2060,2737,2060,2232,2174,1296,2246,2771,1354,2435,2557,1224,564,2893,281,2718,812,2796,2312,1209,2899,115,2120,1127,1066,324,1867,1287,1050,645,213,742,2219,1299,1434,1485,1579,1081,273,1563,406,2615,2071,1968,590,2252,288,920,1391,1216,1323,2156,2808,1928,2282,672,598,1754,1427,2196,602,1795,1047,37,2180,1656,1655,1961,2192,1081,548,2601,950,2082,2233,2506,2101,2296,2249,337,781,223,383,1657,376,2102,1548,1439,2838,1687,2476,624,1720,2878,2987,1807,2338,447,856,1649,2852,519,2266,627,78,1787,484,2724,420,1567,409,2353,1236,873,2465,1844,242,2507,2554,854,115,1994,836,291,1860,1990,2961,2884,2557,2408,320,731,21,64,1753,131,2228,1058,2592,820,614,44,532,2276,2920,2195,1500,401,2272,2201,1207,2870,2699,2043,747,2568,2223,307,2650,792,82,2828,116,1486,2782,2659,2574,2700,421,1151,20,391,1570,2564,597,1798,603,559,858,548,235,2505,972,2803,1213,2335,1487,1757,2390,2420,2410,1318,981,1504,2843,2991,1481,2181,2568,2613,1574,1100,2774,2883,1313,2096,984,514,2925,539,2836,291,2604,1008,1121,2401,1085,900,619,215,2204,1959,1829,495,2149,1677,1222,1049,2255,2873,2580,2220,827,729,2695,1588,2238,354,2304,2322,1353,2167,676,949,685,2063,13,810,2014,695,2044,2078,1861,1248,2849,167,1993,1660,1105,1514,1430,2599,822,1534,2753,503,1496,2243,724,1627,837,1007,643,320,770,1813,413,1824,1834,2420,814,1364,1929,1093,981,2155,792,1941,2693,1858,2351,1402,1832,1465,2101,1503,2658,826,1965,1492,1743,2923,94,2989,863,761,2261,559,1952,44,28,1308,707,1269,1136,357,1706,2404,2518,1462,2161,165,1221,360,1714,2825,1896,1188,2351,1510,1413,1126,2063,1610,2790,1924,1034,2512,242,1997,1906,1184,1405,2449,895,2313,1779,89,456,1447,2649,996,806,1407,1137,2516,2633,891,92,1690,820,1497,2958,2032,888,2036,2339,527,488,285,354,329,980,690,2681,1081,746,2741,2663,479,2,84,1883,846,1495,2120,226,2114,973,73,901,1229,876,635,311,727,2699,2220,1942,2669,407,1788,2806,2070,1054,273,2609,1445,2688,1710,2426,1527,1746,2647,731,616,478,24,2291,1498,474,2051,1614,1401,505,2946,1704,2905,1372,976,1550,278,1332,361,1359,1697,2932,2983,1458,389,1786,1415,1921,2783,2205,1280,1173,2206,581,709,2003,2955,2352,2391,2205,2087,2260,2560,2700,1233,2984,1678,1274,2933,2995,542,2344,1543,871,864,2709,1413,2490,2426,1481,2931,700,2627,2108,2998,2185,2661,344,2287,2726,2322,952,1730,1436,369,1350,481,394,2137,2387,1705,1,2319,875,960,2220,1383,697,1471,2997,2952,476,577,305,2012,2777,1833,1536,1463,438,2240,1375,2871,2238,675,1994,2238,2705,549,45,57,1396,674,434,7,353,2039,185,418,2930,829,2314,391,1712,265,1999,2077,1500,2201,1988,93,1869,1713,2997,520,2979,2720,2456,2702,2753,2087,1484,1124,375,1958,2175,2440,1614,2516,2849,1468,1624,1547,1598,1168,198,666,2220];

                var gotProps = false;
                var chainScanPre = 'https://etherscan.io/tx/'
    
                const partyRaffleAddress = "0xfB6798e50b0618C5013a26eb61fb51cbdB13c615";  //sepolia 2
                const partyRaffleABI = [{"inputs":[{"internalType":"uint64","name":"subscriptionId","type":"uint64"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[{"internalType":"address","name":"have","type":"address"},{"internalType":"address","name":"want","type":"address"}],"name":"OnlyCoordinatorCanFulfill","type":"error"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"}],"name":"OwnershipTransferRequested","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"playa","type":"address"},{"indexed":false,"internalType":"uint256","name":"requestId","type":"uint256"},{"indexed":false,"internalType":"uint256[]","name":"randomWords","type":"uint256[]"}],"name":"RequestFulfilled","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"requestId","type":"uint256"},{"indexed":false,"internalType":"uint32","name":"numWords","type":"uint32"}],"name":"RequestSent","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256[]","name":"rando","type":"uint256[]"}],"name":"loaded","type":"event"},{"inputs":[],"name":"_miladyXAddress","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"_mmpAddress","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"_pixeladyXAddress","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"_remilioXAddress","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"acceptOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"winner","type":"address"}],"name":"blackCheck","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"pure","type":"function"},{"inputs":[],"name":"checkCoin","outputs":[{"internalType":"uint256[3]","name":"","type":"uint256[3]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint32","name":"numWin","type":"uint32"}],"name":"drawPrize","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_requestId","type":"uint256"}],"name":"getRequestStatus","outputs":[{"internalType":"bool","name":"fulfilled","type":"bool"},{"internalType":"uint256[]","name":"randomWords","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"lastRequestId","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"miladyWinnerCount","outputs":[{"internalType":"uint16","name":"","type":"uint16"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"pixeladyWinnerCount","outputs":[{"internalType":"uint16","name":"","type":"uint16"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"randomness","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"range","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"requestId","type":"uint256"},{"internalType":"uint256[]","name":"randomWords","type":"uint256[]"}],"name":"rawFulfillRandomWords","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"remilioWinnerCount","outputs":[{"internalType":"uint16","name":"","type":"uint16"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"requestIds","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"s_requests","outputs":[{"internalType":"bool","name":"fulfilled","type":"bool"},{"internalType":"bool","name":"exists","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256[]","name":"tokenId","type":"uint256[]"},{"internalType":"uint8[]","name":"which","type":"uint8[]"}],"name":"sendIt","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint32","name":"newGas","type":"uint32"}],"name":"setGasLimit","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"withdrawCoins","outputs":[],"stateMutability":"nonpayable","type":"function"}];
                var raffle = new web3.eth.Contract(partyRaffleABI,partyRaffleAddress);

                // mainnet
                const mmpAddress = "0xB24BaB1732D34cAD0A7C7035C3539aEC553bF3a0";
                const mmpABI = [{"inputs":[{"internalType":"uint64","name":"subscriptionId","type":"uint64"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[{"internalType":"address","name":"have","type":"address"},{"internalType":"address","name":"want","type":"address"}],"name":"OnlyCoordinatorCanFulfill","type":"error"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"}],"name":"OwnershipTransferRequested","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"playa","type":"address"},{"indexed":false,"internalType":"uint256","name":"requestId","type":"uint256"},{"indexed":false,"internalType":"uint256[]","name":"randomWords","type":"uint256[]"}],"name":"RequestFulfilled","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"requestId","type":"uint256"},{"indexed":false,"internalType":"uint32","name":"numWords","type":"uint32"}],"name":"RequestSent","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256[]","name":"rando","type":"uint256[]"}],"name":"loaded","type":"event"},{"inputs":[],"name":"_miladyXAddress","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"_mmpAddress","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"_pixeladyXAddress","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"_remilioXAddress","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"acceptOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"winner","type":"address"}],"name":"blackCheck","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"pure","type":"function"},{"inputs":[],"name":"checkCoin","outputs":[{"internalType":"uint256[3]","name":"","type":"uint256[3]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint32","name":"numWin","type":"uint32"}],"name":"drawPrize","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_requestId","type":"uint256"}],"name":"getRequestStatus","outputs":[{"internalType":"bool","name":"fulfilled","type":"bool"},{"internalType":"uint256[]","name":"randomWords","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"lastRequestId","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"miladyWinnerCount","outputs":[{"internalType":"uint16","name":"","type":"uint16"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"pixeladyWinnerCount","outputs":[{"internalType":"uint16","name":"","type":"uint16"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"randomness","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"range","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"requestId","type":"uint256"},{"internalType":"uint256[]","name":"randomWords","type":"uint256[]"}],"name":"rawFulfillRandomWords","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"remilioWinnerCount","outputs":[{"internalType":"uint16","name":"","type":"uint16"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"requestIds","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"s_requests","outputs":[{"internalType":"bool","name":"fulfilled","type":"bool"},{"internalType":"bool","name":"exists","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256[]","name":"tokenId","type":"uint256[]"},{"internalType":"uint8[]","name":"which","type":"uint8[]"}],"name":"sendIt","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint32","name":"newGas","type":"uint32"}],"name":"setGasLimit","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"withdrawCoins","outputs":[],"stateMutability":"nonpayable","type":"function"}];
                // var ms = new web3.eth.Contract(msABI,msAddress);
    
                //functions
                    //Site+Contract logic
                    getProps = async() => {
                        var meta;
                        
                        try{
                            let block = await web3.eth.getTransaction(creationHash)
                            time = await web3.eth.getBlock(block.blockNumber);
                            time = time.timestamp;
                            console.log('time in props',time)
                            winnerMCount = await raffle.methods.miladyWinnerCount().call();
                            winnerRCount = await raffle.methods.remilioWinnerCount().call();
                            winnerPCount = await raffle.methods.pixeladyWinnerCount().call();
                            randomness[0] = await raffle.methods.randomness(0).call();
                            randomness[1] = await raffle.methods.randomness(1).call();
                        } catch (err) {
                            console.log('props getter err',err);
                        }
                        
                        gotProps = true;
                    }
                    popProps = () => {
                        let times = get('time');
                        let mWin = get('mWin');
                        let rWin = get('rWin');
                        let pWin = get('pWin');
                        console.log(time);
                        let currentTimestamp = Math.floor(Date.now() / 1000);
                        console.log(currentTimestamp);
                        let ageInSeconds = currentTimestamp - time;
                        console.log(ageInSeconds);
                        let ageInMinutes = ageInSeconds / 60;
                        console.log(ageInMinutes);
                        let ageInHours = ageInMinutes / 60;
                        console.log(ageInHours);
                        
                        times.innerHTML = "Partying for "+ageInHours+"Hours";
                        mWin.innerHTML = "This many milady won:"+winnerMCount;
                        rWin.innerHTML = "This many Remilio won:"+winnerRCount;
                        pWin.innerHTML = "This many Pixelady won:"+winnerPCount;
                    }
                    getProps();
                    
                    //Raffle Logic

                    //User logic
                    //gets accounts and checks chain id then sends to checkWallet()
                    connectWallet = async(flowSwitch) => {
                        web3 = new Web3(Web3.givenProvider);
                        raffle = new web3.eth.Contract(partyRaffleABI,partyRaffleAddress);
                        //mmp = new web3.eth.Contract(msABI,msAddress);
                        try {
                            accounts = await web3.eth.requestAccounts().then()
                            if(accounts[0]){
                                connected = true;
                            }
                        } catch(err) {
                            console.log('connectWallet requestAccounts error',err.message);
                        }
                        if(connected){
                            var networkId = await web3.eth.net.getId();
                            
                            if (networkId !== 11155111) {
                                alert('change your network to sepolia ethereum')
                            }
                            var connect = document.getElementById('connect');
                            connect.innerHTML = 'Connected';
                            connect.disabled = true;
                            connect.style.display = 'none';
                            //checkWallet should see miladystation holder
                            checkWallet();
                        }
                        var pop = document.getElementById('pop');
                        if(pop.style.display != 'none' || pop.style.display != ''){
                            switch(flowSwitch){
                                //no flow
                                case 0: 
                                    partyFlow();
                                    break;
                            } 
                        }
                    }
                    //checks miladystation holder just for website stuff, merkle in market contract is line of defense
                    checkWallet = async() => {
                        //mmp host check
                        //testing as miladycola host
                        if(accounts[0] == admin){
                            friend = true;
                        }
                        // if(friend) {
                        //     partyFlow();
                        // }
                        
                    }
                    //user clicks buy button, needs to check approval for currency and price
                    //big, working with the item
                    itemFlow = async(id) => {
                        target = id;

                        var pop = document.getElementById('pop');
                        if(pop.style.display == '' || pop.style.display == 'none'){
                            showPop(1);
                        }
                        var innerHTML = "";
                        if(!connected) {
                            //connect button
                            innerHTML = `
                            <h3>Please Connect your Wallet</h3>
                            <button id="connect" onclick="connectWallet(1)">Connect Wallet</button>
                            `;
                        } else {
                            var accountHash = web3.utils.soliditySha3(accounts[0]);
                            var proof = tree.getHexProof(accountHash);
                            //seller menu
                            if(listings[id].seller == accounts[0]) {
                                
                                innerHTML = `
                                    <h3>This is your listing. Whatsup</h3>
                                    <button onclick="cancelListing(${target})">Cancel Listing</button>
                                    <input id="new-price-input">
                                    <button onclick="editListing(${target})">Edit Price</button>
                                    `;
                            //buyer flow
                            } else {
                                //check allowance
                                let allow = await checkAllowance(listings[target].currency)
                                if(allow >= listings[id].price){
                                    
                                    if(tree.verify(proof,accountHash,root)){
                                        innerHTML = `
                                            <button onclick="buyFriend(${target})">BUY</button>
                                            `;
                                    } else {
                                        innerHTML = `
                                            <button onclick="buy(${target})">BUY</button>
                                            `;
                                    }
                                } else {
                                    innerHTML = `
                                        <h3>Must Approve Currency for Purchase</h3>
                                        <button onclick="setAllowance('${listings[target].currency}','${listings[target].price}')">Approve Coin</button>
                                        `;
                                    console.log('allowance != price');
                                }
                            }
                        }
                        popPop(innerHTML,1);
                    }
                    wizardFlow = async() => {
                        var pop = document.getElementById('pop');
                        if(pop.style.display == '' || pop.style.display == 'none'){
                            showPop(1);
                        }
                        var innerHTML = "";
                        if (!connected) {
                            innerHTML = `
                                <h3>Please Connect your Wallet</h3>
                                <button id="connect" onclick="connectWallet(2)">Connect Wallet</button>
                            `
                        } else {
                            
                            innerHTML = `
                                    <h3>Hiiiiiii ${accounts[0]}</h3>
                                    <h3>Let's create your listing</h3>
                                    
                                        <div>
                                            <label>NFT Token Standard</label>
                                            <input id="erc-input" placeholder="721 or 1155">
                                        </div>
                                        <div>
                                            <label>NFT Collection Contract Address</label>
                                            <input id="collection-input" placeholder="0x0000000000000000000000000000">
                                        </div>
                                        <div>
                                            <label>ERC20 Currency Contract Address</label>
                                            <input id="currency-input" placeholder="0x0000000000000000000000000000">
                                        </div>
                                        <div>
                                            <label>NFT Collection Token Id</label>
                                            <input id="tokenId-input" placeholder="69">
                                        </div>
                                        <div>
                                            <label>Price in Chosen ERC20 (include all decimals)</label>
                                            <input id="price-input" placeholder="100000000">
                                        </div>
                                        <div>
                                            <label>I agree to <a onclick="showTerms()">terms and conditions</a></label>
                                            <input id="terms-input" type="checkbox">
                                        </div>
                                        <div>
                                            <button id="listing-form-button" onclick="createListing()">Create Market Listing</button>
                                        </div>
                                    
                                        `;
                        }
                        popPop(innerHTML,1);
                    }
                    showTerms = () => {
                        var pop = get("pop2");
                        if(pop.style.display == '' || pop.style.display == 'none'){
                            showPop(2);
                        }
                        var innerHTML = "";
                        innerHTML = `
                            <h2>Terms and Conditions</h2>
                            <p>Double check that the url is monygroup.net/raffle</p>
                            <p>Double check that the NFT approval is for what you are trying to sell</p>
                            <p>Double check in the wallet that the create listing interaction is with ${raffleAddress}</p>
                            <p>Consider this a private beta. Maybe use a separate wallet to interact</p>
                            <p>You need to setApprovalAll the contract address. The wizard automatically prompts that transaction first after checking to see if your wallet already has it approved.</p>
                            <p>Your buyer will also need to set their allowance to spend the erc20 with the contract.</p>
                            <p>IT SHOULD WORK but lmk</p>
                            <p>Also by interacting with this contract you agree that Remilia rules and penguins/apes/punks/seals/etc drool</p>
                            <p>Also you affirm that miladystation is an interesting complimentary collection and NOT A GRIFT</p>
                            <p>thank you</p>
                        `
                        popPop(innerHTML,2);
                    }

                    partyFlow = async() => {
                        console.log('lets party');
                        var pop = document.getElementById('pop');
                        if(pop.style.display == '' || pop.style.display == 'none'){
                            showPop(1);
                        }
                        var innerHTML = "";
                        if (!connected) {
                            innerHTML = `
                                <h3>Please Connect your Wallet</h3>
                                <button id="connect" onclick="connectWallet(0)">Connect Wallet</button>
                            `
                            popPop(innerHTML,1);
                        } else {
                            if(friend){
                                innerHTML = `
                                    <h3>Dashboard</h3>
                                    <p>welcome back king, lets give out some party favors</p>
                                    <div>
                                        <div id="props">
                                            <ul>
                                                <li id="time"></li>
                                                <li id="mWin"></li>
                                                <li id="rWin"></li>
                                                <li id="pWin"></li>
                                            </ul>
                                        </div>
                                        <div id="party">
                                            <button onclick="drawFlow()">Draw Names</button>
                                        </div>
                                        `;
                            }
                            popPop(innerHTML,0);
                            popProps();
                        }

                    }
                    drawFlow = async() => {

                    }
        </script>

    </body>

    
</html>